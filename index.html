<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
<title>Mini Cozy Survival</title>
<style>
  :root{
    --bg:#0b0f14; --ink:#e7f2ff; --muted:#9fb3c8; --acc1:#7ef2c4; --acc2:#ffd884;
    --danger:#ff4d4d; --warn:#ffbf5f; --ok:#7bff9d; --edge:#0a0e13;
  }
  html,body{height:100%}
  body{
    margin:0; background:var(--bg); color:var(--ink);
    font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace;
    image-rendering: pixelated; -webkit-font-smoothing: none; text-rendering: optimizeSpeed;
    display:flex; align-items:center; justify-content:center;
    touch-action: manipulation;
  }
  .wrap{ width:min(720px, 100%); padding:12px; padding-bottom:110px; } /* space for HUD */
  .title{text-align:center; font-weight:900; font-size:22px; line-height:1; text-shadow:0 2px 0 #000; margin-bottom:10px;}
  .grid{display:grid; gap:8px; grid-template-columns: 1fr;}
  .card{background:linear-gradient(#151d27,#0f151c); border:3px solid var(--edge);
        box-shadow:0 0 0 2px #000, 0 6px 0 #0008; border-radius:8px; padding:10px;}
  .stats{display:grid; grid-template-columns: repeat(2,1fr); gap:8px;}
  .bar{background:#0b1117; border:2px solid #000; border-radius:6px; padding:6px; box-shadow: inset 0 0 0 2px #0006; font-size:12px;}
  .bar .row{display:flex; justify-content:space-between; margin-bottom:4px;}
  .meter{height:8px; background:#091017; border:2px solid #000; border-radius:4px; overflow:hidden;}
  .meter span{display:block; height:100%; width:50%; background:linear-gradient(90deg, var(--acc1), var(--acc2));}
  .caps{font-weight:800; text-transform:uppercase; font-size:11px; letter-spacing:1px; color:var(--muted);}
  .big{font-size:14px; font-weight:800;}
  .row{display:flex; gap:8px; align-items:center; flex-wrap:wrap;}
  .btn{
    flex:1 1 auto; padding:12px 10px; font-weight:800; font-size:14px; text-align:center;
    background:linear-gradient(#1b2633,#121923); border:3px solid #000; border-radius:10px;
    box-shadow:0 4px 0 #0008; color:var(--ink); cursor:pointer; user-select:none;
  }
  .btn:active{ transform: translateY(2px); box-shadow: 0 2px 0 #0008;}
  .btn.ok{border-color:#003a1a} .btn.warn{border-color:#3a0000} .btn.small{padding:8px 10px; font-size:12px}
  .pill{display:inline-block; padding:2px 10px; border:2px solid #000; border-radius:999px; font-weight:900; font-size:12px;}
  .pill.win{background:#0f2; color:#001b00} .pill.lose{background:#f33; color:#220000}
  .log{height:140px; overflow:auto; background:#0b1117; border:2px solid #000; border-radius:6px; padding:8px; font-size:13px; line-height:1.3;}
  .log p{margin:0 0 6px 0}
  .inv{display:grid; grid-template-columns: repeat(3,1fr); gap:6px; font-size:13px}
  .inv .it{background:#0b1117; border:2px solid #000; border-radius:6px; padding:6px;}
  .split{display:grid; gap:8px; grid-template-columns: 1fr}
  @media (min-width:680px){ .split{grid-template-columns: 1fr 1fr;} }
  .footer{opacity:.7; text-align:center; font-size:11px; margin-top:6px}

  /* ===== Sticky HUD ===== */
  .hud{
    position:fixed; left:0; right:0; bottom:0;
    background:linear-gradient(#0e141c,#0a0f15);
    border-top:3px solid #000; box-shadow:0 -4px 0 #0008, 0 0 0 2px #000 inset;
    padding:10px 12px calc(10px + env(safe-area-inset-bottom));
    display:flex; gap:6px; flex-wrap:wrap; justify-content:center;
    z-index:10;
  }
  .statpill{
    display:inline-flex; align-items:center; gap:6px;
    padding:6px 10px; border-radius:999px; font-weight:900; font-size:12px;
    border:2px solid #000; box-shadow:0 2px 0 #0006; user-select:none;
  }
  .statpill .label{opacity:.85; text-transform:uppercase; letter-spacing:.6px}
  .statpill .val{font-weight:900}
  .good{background:#17361f;}
  .warn{background:#3a2e12;}
  .bad{ background:#3a1515;}
  .good .val{color:var(--ok)} .warn .val{color:var(--warn)} .bad .val{color:var(--danger)}
</style>
</head>
<body>
<div class="wrap">
  <div class="title">üå≤ MINI COZY SURVIVAL ‚Äî <span id="day">Day 1</span></div>
  <div class="grid">
    <div class="split">
      <div class="card">
        <div class="stats">
          <div class="bar" id="healthBar">
            <div class="row"><span class="caps">Health</span><span class="big" id="hpTxt">100</span></div>
            <div class="meter"><span id="hpMeter"></span></div>
          </div>
          <div class="bar" id="energyBar">
            <div class="row"><span class="caps">Energy</span><span class="big" id="enTxt">80</span></div>
            <div class="meter"><span id="enMeter"></span></div>
          </div>
          <div class="bar">
            <div class="row"><span class="caps">Hunger</span><span class="big" id="huTxt">20</span></div>
            <div class="meter"><span id="huMeter"></span></div>
          </div>
          <div class="bar">
            <div class="row"><span class="caps">Thirst</span><span class="big" id="thTxt">20</span></div>
            <div class="meter"><span id="thMeter"></span></div>
          </div>
          <div class="bar">
            <div class="row"><span class="caps">Warmth</span><span class="big" id="wmTxt">50</span></div>
            <div class="meter"><span id="wmMeter"></span></div>
          </div>
          <div class="bar">
            <div class="row"><span class="caps">Shelter</span><span class="big" id="shTxt">0</span></div>
            <div class="meter"><span id="shMeter"></span></div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="caps">Inventory</div>
        <div class="inv" id="inv"></div>
        <div class="row" style="margin-top:8px">
          <div class="btn small" id="saveBtn">üíæ Save</div>
          <div class="btn small" id="loadBtn">üì¶ Load</div>
          <div class="btn small warn" id="newBtn">üßπ New Run</div>
        </div>
      </div>
    </div>

    <div class="card">
      <div class="caps">Actions (each uses part of the day)</div>
      <div class="row" style="margin-top:6px">
        <div class="btn" data-act="forage">üçì Forage</div>
        <div class="btn" data-act="water">üíß Gather Water</div>
        <div class="btn" data-act="rest">üõå Rest</div>
      </div>
      <div class="row" style="margin-top:6px">
        <div class="btn" data-act="explore">üß≠ Explore</div>
        <div class="btn" data-act="craft">üõ†Ô∏è Craft</div>
        <div class="btn" data-act="cook">üî• Use Campfire</div>
      </div>
      <div class="row" style="margin-top:6px">
        <div class="btn" data-act="eat">ü•£ Eat</div>
        <div class="btn" data-act="drink">ü•§ Drink</div>
        <div class="btn ok" data-act="endday">üåô End Day</div>
      </div>
    </div>

    <div class="card">
      <div class="caps">Journal</div>
      <div class="log" id="log"></div>
    </div>

    <div class="card">
      <div class="caps">Crafting</div>
      <div class="row" style="margin-top:6px">
        <div class="btn small" data-craft="campfire">üî• Campfire (Wood x4, Stone x2)</div>
        <div class="btn small" data-craft="spear">ü™ì Spear (Wood x2, Stone x1)</div>
        <div class="btn small" data-craft="shelter">üèïÔ∏è Shelter (Wood x6, Cloth x1)</div>
      </div>
      <div class="row" style="margin-top:6px">
        <div class="btn small" data-craft="boil">‚ô®Ô∏è Boil Water (Dirty‚ÜíClean)</div>
        <div class="btn small" data-craft="cookBerries">üç≤ Cook Berries (+Food)</div>
      </div>
    </div>

    <div class="footer">
      Survive 10 days to win. If <span class="pill lose">Health 0</span> ‚Äî game over. Cozy pixel vibes only ‚ú®
    </div>
  </div>
</div>

<!-- Sticky HUD -->
<div class="hud" id="hud">
  <!-- pills are injected by JS -->
</div>

<script>
(function(){
  const el = id => document.getElementById(id);
  const logEl = el('log'), hudEl = el('hud');

  const state = {
    day: 1,
    hp: 100,
    energy: 80,
    hunger: 20,   // 0 good ‚Üí 100 starving
    thirst: 20,   // 0 good ‚Üí 100 parched
    warmth: 50,
    shelter: 0,
    hasCampfire: false,
    items: { Wood: 3, Stone: 1, Berries: 2, "Water (Dirty)": 1, "Water (Clean)": 1, Cloth: 0, Food: 1 },
    crafted: { spear:false },
    turns: 0, // turns taken today (max 4 per day)
  };

  const MAX_TURNS = 4;
  const WIN_DAY = 10;

  function clamp(v,min,max){return Math.max(min,Math.min(max,v));}
  function pct(v){return clamp(v,0,100);}
  function setMeter(id,value){ el(id).style.width = pct(value)+'%'; }

  function pillClass(val, invert=false){
    // invert: lower is better (hunger/thirst)
    const score = invert ? 100 - val : val;
    if (score >= 70) return 'good';
    if (score >= 35) return 'warn';
    return 'bad';
  }

  function drawHUD(){
    // Build pills fresh each draw
    hudEl.innerHTML = '';
    const pills = [
      {label:'Health',  val: Math.round(state.hp),       invert:false, icon:'‚ù§Ô∏è'},
      {label:'Energy',  val: Math.round(state.energy),   invert:false, icon:'‚ö°Ô∏è'},
      {label:'Thirst',  val: Math.round(state.thirst),   invert:true,  icon:'üíß'},
      {label:'Hunger',  val: Math.round(state.hunger),   invert:true,  icon:'üçΩÔ∏è'},
      {label:'Warmth',  val: Math.round(state.warmth),   invert:false, icon:'üî•'},
      {label:'Shelter', val: Math.round(state.shelter),  invert:false, icon:'‚õ∫Ô∏è'},
    ];
    pills.forEach(p=>{
      const d = document.createElement('div');
      d.className = `statpill ${pillClass(p.val, p.invert)}`;
      d.innerHTML = `<span class="label">${p.icon} ${p.label}</span><span class="val">${p.val}</span>`;
      hudEl.appendChild(d);
    });
  }

  function draw(){
    el('day').textContent = 'Day ' + state.day;
    el('hpTxt').textContent = Math.round(state.hp);
    el('enTxt').textContent = Math.round(state.energy);
    el('huTxt').textContent = Math.round(state.hunger);
    el('thTxt').textContent = Math.round(state.thirst);
    el('wmTxt').textContent = Math.round(state.warmth);
    el('shTxt').textContent = Math.round(state.shelter);

    setMeter('hpMeter',state.hp);
    setMeter('enMeter',state.energy);
    setMeter('huMeter',100-state.hunger); // invert: lower hunger is better
    setMeter('thMeter',100-state.thirst); // invert
    setMeter('wmMeter',state.warmth);
    setMeter('shMeter',state.shelter);

    // inventory
    const inv = el('inv'); inv.innerHTML='';
    Object.entries(state.items).forEach(([k,v])=>{
      if (v<=0) return;
      const d = document.createElement('div');
      d.className='it';
      d.textContent = k + ': ' + v;
      inv.appendChild(d);
    });

    drawHUD();
  }

  function log(msg){
    const p = document.createElement('p');
    p.innerHTML = msg;
    logEl.prepend(p);
  }

  function spendTurn(costEnergy=8){
    if (state.turns>=MAX_TURNS) { log("‚è≥ You‚Äôve used all actions today. Tap <b>End Day</b>."); return false; }
    if (state.energy < costEnergy){ log("üòµ You‚Äôre too tired. Try <b>Rest</b> or <b>End Day</b>."); return false; }
    state.energy = clamp(state.energy - costEnergy, 0, 100);
    state.turns++;
    return true;
  }

  function gainItem(name, n=1){ state.items[name] = (state.items[name]||0) + n; }
  function useItem(name, n=1){ if ((state.items[name]||0) >= n){ state.items[name]-=n; return true; } return false; }

  // Softer survival tick (cozier)
  function hungerThirstTick(hu=6, th=8){
    state.hunger = clamp(state.hunger + hu, 0, 100);
    state.thirst = clamp(state.thirst + th, 0, 100);

    let dmg = 0;
    if (state.thirst >= 90) dmg += 6;
    if (state.hunger >= 90) dmg += 4;
    if (state.warmth <= 15 && state.shelter < 50) dmg += 3;
    state.hp = clamp(state.hp - dmg, 0, 100);
    if (dmg>0) log(`üí¢ Suffering from conditions (<b>${dmg}</b> dmg).`);
  }

  function randomInt(a,b){return Math.floor(Math.random()*(b-a+1))+a;}
  function chance(p){return Math.random()<p;}

  const actions = {
    forage(){
      if (!spendTurn(7)) return;
      const finds = [];
      if (chance(.8)){ const n=randomInt(1,3); gainItem('Berries',n); finds.push(`üçì x${n}`);}
      if (chance(.5)){ const n=randomInt(1,3); gainItem('Wood',n); finds.push(`ü™µ x${n}`);}
      if (chance(.2)){ gainItem('Cloth',1); finds.push("üßµ Cloth x1");}
      hungerThirstTick(5,6);
      state.warmth = clamp(state.warmth - 2,0,100);
      log(finds.length ? `üåø You foraged and found ${finds.join(', ')}.` : "üåø You foraged but found nothing this time.");
      maybeEvent();
      draw();
    },
    water(){
      if (!spendTurn(6)) return;
      const n = randomInt(1,3);
      gainItem('Water (Dirty)', n);
      hungerThirstTick(3,2);
      log(`üíß Collected dirty water x${n}. Boil it at the <b>Campfire</b> before drinking!`);
      draw();
    },
    rest(){
      if (!spendTurn(0)) return;
      const e = randomInt(10,18);
      state.energy = clamp(state.energy + e, 0, 100);
      state.warmth = clamp(state.warmth + (state.hasCampfire?8:2) + (state.shelter>0?6:0),0,100);
      hungerThirstTick(4,5);
      log(`üõå You rested (+${e} energy).`);
      draw();
    },
    explore(){
      if (!spendTurn(10)) return;
      hungerThirstTick(7,9);
      state.warmth = clamp(state.warmth - 4,0,100);
      if (chance(.55)){
        const roll = randomInt(1,5);
        if (roll===1){ gainItem('Stone',randomInt(1,3)); log('ü™® You discovered some stones.'); }
        if (roll===2){ gainItem('Wood',randomInt(2,4)); log('üå≤ You found fallen branches.'); }
        if (roll===3){ gainItem('Berries',randomInt(2,4)); log('üçá A small thicket of berries!'); }
        if (roll===4){ gainItem('Cloth',1); log('üß• Tattered cloth caught on a branch.'); }
        if (roll===5){ gainItem('Food',1); log('ü•´ Lucky! You found a sealed tin (Food x1).'); }
      } else {
        log('üß≠ You wandered but nothing useful turned up.');
      }
      if (state.crafted.spear && chance(.2)){
        log('ü¶å You used your spear to scare off a boar and salvaged meat (+Food x1).');
        gainItem('Food',1);
      }
      maybeEvent();
      draw();
    },
    craft(){
      if (!spendTurn(4)) return;
      hungerThirstTick(2,2);
      log('üõ†Ô∏è You organize your supplies and prep for crafting. Use the buttons in the Crafting panel.');
      draw();
    },
    cook(){
      if (!state.hasCampfire){ log('üî• You need a <b>Campfire</b> first. Craft it!'); return; }
      if (!spendTurn(4)) return;
      hungerThirstTick(2,2);
      if (state.items.Berries>0){
        const n = Math.min(state.items.Berries, randomInt(1,2));
        useItem('Berries', n);
        state.hunger = clamp(state.hunger - 10*n, 0, 100);
        gainItem('Food',1);
        log(`üç≤ You cooked berries into a simple meal (-${n} berries, +Food x1).`);
      } else {
        log("üî• You sat by the campfire and warmed up, but had nothing to cook.");
      }
      draw();
    },
    eat(){
      if (!spendTurn(2)) return;
      if (useItem('Food',1)){
        state.hunger = clamp(state.hunger - 25, 0, 100);
        state.hp = clamp(state.hp + 6, 0, 100);
        log('ü•£ You ate a meal (-Food x1, hunger eased, +HP).');
      } else {
        log('‚ùå No Food in inventory.');
      }
      draw();
    },
    drink(){
      if (!spendTurn(2)) return;
      if (useItem('Water (Clean)',1)){
        state.thirst = clamp(state.thirst - 30, 0, 100);
        state.hp = clamp(state.hp + 4, 0, 100);
        log('ü•§ You drank clean water (-1).');
      } else if (state.items['Water (Dirty)']>0){
        log('‚ö†Ô∏è You have dirty water ‚Äî boil it at the Campfire first.');
      } else {
        log('‚ùå No water to drink.');
      }
      draw();
    },
    endday(){
      state.day++;
      state.turns = 0;
      hungerThirstTick(8,9); // gentler night
      state.energy = clamp(state.energy + 15, 0, 100);
      if (state.shelter > 0) state.warmth = clamp(state.warmth + 10, 0, 100);
      else state.warmth = clamp(state.warmth - 5, 0, 100);
      log(`üåô You rest for the night. A new day dawns.`);
      if (state.day > WIN_DAY) log(`<span class="pill win">üèÜ You survived ${WIN_DAY} days! You win!</span>`);
      draw();
      checkGameOver();
    }
  };

  const crafting = {
    campfire(){
      if (useItem('Wood',4) && useItem('Stone',2)){
        state.hasCampfire = true;
        log('üî• You built a campfire.');
      } else { log('‚ùå Not enough resources for a campfire.'); }
      draw();
    },
    spear(){
      if (useItem('Wood',2) && useItem('Stone',1)){
        state.crafted.spear = true;
        log('ü™ì You crafted a spear.');
      } else { log('‚ùå Not enough resources for a spear.'); }
      draw();
    },
    shelter(){
      if (useItem('Wood',6) && useItem('Cloth',1)){
        state.shelter = 100;
        log('üèïÔ∏è You built a shelter.');
      } else { log('‚ùå Not enough resources for shelter.'); }
      draw();
    },
    boil(){
      if (useItem('Water (Dirty)',1)){
        gainItem('Water (Clean)',1);
        log('‚ô®Ô∏è You boiled dirty water into clean water.');
      } else { log('‚ùå No dirty water to boil.'); }
      draw();
    },
    cookBerries(){
      if (useItem('Berries',2)){
        gainItem('Food',1);
        log('üç≤ Cooked berries into a meal.');
      } else { log('‚ùå Need at least 2 berries to cook.'); }
      draw();
    }
  };

  function maybeEvent(){
    if (chance(0.15)){
      const roll = randomInt(1,3);
      if (roll===1){ log('üåß It rained, your warmth dropped a bit.'); state.warmth = clamp(state.warmth - 5,0,100); }
      if (roll===2){ log('üêç You startled a snake and lost some health.'); state.hp = clamp(state.hp - 5,0,100); }
      if (roll===3 && state.crafted.spear){ log('ü¶å You used your spear to catch some meat (+Food x1).'); gainItem('Food',1); }
    }
  }

  function checkGameOver(){
    if (state.hp <= 0){
      log(`<span class="pill lose">üíÄ You died. Game Over.</span>`);
      document.querySelectorAll('.btn').forEach(b=>b.onclick=null);
    }
  }

  function saveGame(){ localStorage.setItem('cozySurvival', JSON.stringify(state)); log('üíæ Game saved.'); }
  function loadGame(){
    const data = localStorage.getItem('cozySurvival');
    if (data){ Object.assign(state, JSON.parse(data)); log('üì¶ Game loaded.'); draw(); }
    else log('‚ö†Ô∏è No saved game found.');
  }
  function newGame(){ localStorage.removeItem('cozySurvival'); location.reload(); }

  document.querySelectorAll('[data-act]').forEach(btn=>{
    btn.addEventListener('click',()=>{ actions[btn.dataset.act](); checkGameOver(); });
  });
  document.querySelectorAll('[data-craft]').forEach(btn=>{
    btn.addEventListener('click',()=>{ crafting[btn.dataset.craft](); checkGameOver(); });
  });
  el('saveBtn').onclick = saveGame;
  el('loadBtn').onclick = loadGame;
  el('newBtn').onclick = newGame;

  draw();
  log('üèïÔ∏è Welcome to Mini Cozy Survival! Try to last 10 days.');
})();
</script>
</body>
</html>
